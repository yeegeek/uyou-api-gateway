# 开发环境 Dockerfile (支持热重载)
FROM golang:1.21-alpine

WORKDIR /app

# 安装开发依赖
RUN apk add --no-cache git tzdata

# 设置时区
ENV TZ=Asia/Shanghai

# 安装 air (热重载工具)
RUN go install github.com/cosmtrek/air@latest

# 设置 Go 环境
ENV GO111MODULE=on
ENV GOPROXY=https://goproxy.cn,direct

# 复制依赖文件
COPY go.mod ./
COPY go.sum* ./
RUN go mod download || true

# 暴露端口
EXPOSE {{GRPC_PORT}} {{HTTP_PORT}}

# 使用 air 启动 (热重载)
CMD ["air", "-c", ".air.toml"]
